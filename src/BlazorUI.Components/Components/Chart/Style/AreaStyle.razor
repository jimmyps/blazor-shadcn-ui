@namespace BlazorUI.Components.Chart

@code {
    /// <summary>
    /// Gets or sets the parent ChartStyle component.
    /// </summary>
    [CascadingParameter]
    public ChartStyle? ParentStyle { get; set; }
    
    /// <summary>
    /// Gets or sets whether to show the area fill.
    /// </summary>
    [Parameter]
    public bool Show { get; set; } = true;
    
    /// <summary>
    /// Gets or sets the fill color (solid color, overridden by gradient if LinearGradient child is present).
    /// </summary>
    [Parameter]
    public string? Color { get; set; }
    
    /// <summary>
    /// Gets or sets the opacity (0.0 to 1.0).
    /// </summary>
    [Parameter]
    public double Opacity { get; set; } = 1.0;
    
    /// <summary>
    /// Gets or sets the child content containing gradient configuration.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }
    
    internal LinearGradientConfig? Gradient { get; set; }
    
    protected override void OnInitialized()
    {
        if (ParentStyle == null)
        {
            throw new InvalidOperationException("AreaStyle must be used within a ChartStyle component");
        }
    }
    
    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender)
        {
            ParentStyle?.RegisterAreaStyle(new AreaStyleConfig
            {
                Show = Show,
                Color = Color,
                Opacity = Opacity,
                Gradient = Gradient
            });
        }
    }
    
    /// <summary>
    /// Registers a gradient configuration.
    /// </summary>
    internal void RegisterGradient(LinearGradientConfig config)
    {
        Gradient = config;
    }
}

@if (ChildContent != null)
{
    <CascadingValue Value="this" IsFixed="true">
        @ChildContent
    </CascadingValue>
}
