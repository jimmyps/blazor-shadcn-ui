@namespace BlazorUI.Components.ContextMenu
@using BlazorUI.Components.Utilities
@using BlazorUI.Primitives.Constants

@* ContextMenuContent - styled content panel with transparent overlay *@
<BlazorUI.Primitives.ContextMenu.ContextMenuContent CloseOnEscape="@CloseOnEscape"
                    CloseOnClickOutside="@CloseOnClickOutside"
                    ZIndex="@ZIndex"
                    LockScroll="@LockScroll"
                    OverlayClass="@GetOverlayClass()"
                    class="@GetClass()"
                    @attributes="AdditionalAttributes">
    @ChildContent
</BlazorUI.Primitives.ContextMenu.ContextMenuContent>

@code {
    /// <summary>
    /// The content to render inside the menu.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Whether pressing Escape should close the menu.
    /// </summary>
    [Parameter]
    public bool CloseOnEscape { get; set; } = true;

    /// <summary>
    /// Whether clicking outside should close the menu.
    /// </summary>
    [Parameter]
    public bool CloseOnClickOutside { get; set; } = true;

    /// <summary>
    /// Z-index value for the menu content.
    /// Default is 60 (PopoverContent level).
    /// </summary>
    [Parameter]
    public int ZIndex { get; set; } = ZIndexLevels.PopoverContent;

    /// <summary>
    /// Whether to lock body scroll when menu is open.
    /// Default is true.
    /// </summary>
    [Parameter]
    public bool LockScroll { get; set; } = true;

    /// <summary>
    /// Additional CSS classes to apply.
    /// </summary>
    [Parameter]
    public string? Class { get; set; }

    /// <summary>
    /// Additional attributes to apply.
    /// </summary>
    [Parameter(CaptureUnmatchedValues = true)]
    public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private string GetOverlayClass()
    {
        // Transparent overlay that covers the entire screen
        return "bg-transparent";
    }

    private string GetClass() =>
        ClassNames.cn(
            // Base styles
            $"z-{ZIndex} min-w-[8rem] no-focus-ring overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md",
            // Animation states
            "animate-in fade-in-80",
            "data-[state=open]:animate-in data-[state=closed]:animate-out",
            "data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
            "data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95",
            Class
        );
}
