@namespace BlazorUI.Components.ContextMenu
@using BlazorUI.Components.Utilities
@using BlazorUI.Primitives.Constants

@* ContextMenuSubContent - styled submenu content *@
<BlazorUI.Primitives.ContextMenu.ContextMenuSubContent CloseOnEscape="@CloseOnEscape"
                                                        Offset="@Offset"
                                                        ZIndex="@ZIndex"
                                                        class="@GetClass()"
                                                        @attributes="AdditionalAttributes">
    <div class="p-1">
        @ChildContent
    </div>
</BlazorUI.Primitives.ContextMenu.ContextMenuSubContent>

@code {
    /// <summary>
    /// The content to render inside the submenu.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Whether pressing Escape should close the submenu.
    /// </summary>
    [Parameter]
    public bool CloseOnEscape { get; set; } = true;

    /// <summary>
    /// Offset distance from the trigger in pixels.
    /// </summary>
    [Parameter]
    public int Offset { get; set; } = -4;

    /// <summary>
    /// Z-index for the submenu content.
    /// Default is 60 (PopoverContent level).
    /// </summary>
    [Parameter]
    public int ZIndex { get; set; } = ZIndexLevels.PopoverContent;

    /// <summary>
    /// Additional CSS classes to apply.
    /// </summary>
    [Parameter]
    public string? Class { get; set; }

    /// <summary>
    /// Additional attributes to apply.
    /// </summary>
    [Parameter(CaptureUnmatchedValues = true)]
    public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private string GetClass() =>
        ClassNames.cn(
            // Base styles
            $"z-{ZIndex} min-w-[8rem] no-focus-ring overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg",
            // Animation states
            "data-[state=open]:animate-in data-[state=closed]:animate-out",
            "data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
            "data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95",
            Class
        );
}
