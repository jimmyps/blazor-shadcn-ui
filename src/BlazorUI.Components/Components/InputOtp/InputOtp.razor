@namespace BlazorUI.Components.InputOtp
@using BlazorUI.Primitives.InputOtp

@* Styled InputOtp component - wrapper around OtpRoot primitive *@
<BlazorUI.Primitives.InputOtp.OtpRoot class="@CssClass"
                                        Length="@Length"
                                        Value="@Value"
                                        ValueChanged="@ValueChanged"
                                        DefaultValue="@DefaultValue"
                                        OnValueChange="@OnValueChange"
                                        OnComplete="@OnComplete"
                                        Pattern="@Pattern"
                                        Disabled="@Disabled"
                                        AriaLabel="@AriaLabel"
                                        AriaInvalid="@AriaInvalid">
    @ChildContent
</BlazorUI.Primitives.InputOtp.OtpRoot>

@code {
    /// <summary>
    /// The child content to render within the OTP input.
    /// Typically includes InputOtpSlot components or InputOtpGroup with slots.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Additional CSS classes to apply to the container.
    /// </summary>
    [Parameter]
    public string? Class { get; set; }

    /// <summary>
    /// The number of OTP slots.
    /// Default is 6.
    /// </summary>
    [Parameter]
    public int Length { get; set; } = 6;

    /// <summary>
    /// Controls the OTP value (controlled mode).
    /// </summary>
    [Parameter]
    public string? Value { get; set; }

    /// <summary>
    /// Event callback invoked when the OTP value changes.
    /// Use with @bind-Value for two-way binding.
    /// </summary>
    [Parameter]
    public EventCallback<string> ValueChanged { get; set; }

    /// <summary>
    /// Default value when in uncontrolled mode.
    /// </summary>
    [Parameter]
    public string DefaultValue { get; set; } = "";

    /// <summary>
    /// Event callback invoked when the OTP value changes.
    /// </summary>
    [Parameter]
    public EventCallback<string> OnValueChange { get; set; }

    /// <summary>
    /// Event callback invoked when the OTP is complete.
    /// </summary>
    [Parameter]
    public EventCallback<string> OnComplete { get; set; }

    /// <summary>
    /// Pattern for input validation (e.g., "[0-9]" for digits only).
    /// Default is digits only.
    /// </summary>
    [Parameter]
    public string Pattern { get; set; } = "[0-9]";

    /// <summary>
    /// Whether the OTP input is disabled.
    /// </summary>
    [Parameter]
    public bool Disabled { get; set; } = false;

    /// <summary>
    /// ARIA label for the OTP input group.
    /// </summary>
    [Parameter]
    public string AriaLabel { get; set; } = "One-time password";

    /// <summary>
    /// Whether the OTP input is in an invalid/error state.
    /// When true, aria-invalid="true" is set on the slots, applying error styling.
    /// </summary>
    [Parameter]
    public bool AriaInvalid { get; set; } = false;

    private string CssClass
    {
        get
        {
            var baseClasses = "flex items-center gap-2";
            return string.IsNullOrWhiteSpace(Class) ? baseClasses : $"{baseClasses} {Class}";
        }
    }
}
