@page "/components/select"
@using System.ComponentModel.DataAnnotations

<PageTitle>Select Component - Blazor Blueprint</PageTitle>

<div class="space-y-8 max-w-4xl">
    <div>
        <div class="space-y-3">
        <h1 class="text-4xl font-bold tracking-tight">Select Component</h1>
        <p class="text-xl text-muted-foreground">
            Displays a list of options for the user to pick fromâ€”triggered by a button.
        </p>
        </div>
    </div>

    <div class="space-y-6">
    </div>

    <!-- Basic Select -->
    <section class="space-y-4">
        <h2 class="text-2xl font-semibold">Basic Select</h2>
        <p class="text-sm text-muted-foreground">
            A simple select with a list of options.
        </p>

        <div class="flex items-center gap-4">
            <Select @bind-Value="selectedFruit" TValue="string" Class="w-[280px]">
                <SelectTrigger>
                    <SelectValue Placeholder="Select a fruit" />
                </SelectTrigger>
                <SelectContent>
                    <SelectItem Value="@("apple")" Text="Apple" TValue="string">Apple</SelectItem>
                    <SelectItem Value="@("banana")" Text="Banana" TValue="string">Banana</SelectItem>
                    <SelectItem Value="@("blueberry")" Text="Blueberry" TValue="string">Blueberry</SelectItem>
                    <SelectItem Value="@("grapes")" Text="Grapes" TValue="string">Grapes</SelectItem>
                    <SelectItem Value="@("pineapple")" Text="Pineapple" TValue="string">Pineapple</SelectItem>
                </SelectContent>
            </Select>

            @if (!string.IsNullOrEmpty(selectedFruit))
            {
                <p class="text-sm">Selected: <strong>@selectedFruit</strong></p>
            }
        </div>
    </section>

    <!-- Grouped Select -->
    <section class="space-y-4">
        <h2 class="text-2xl font-semibold">Grouped Options</h2>
        <p class="text-sm text-muted-foreground">
            Organize related items into labeled groups.
        </p>

        <div class="flex items-center gap-4">
            <Select @bind-Value="selectedAnimal" TValue="string" Class="w-[280px]">
                <SelectTrigger>
                    <SelectValue Placeholder="Select an animal" />
                </SelectTrigger>
                <SelectContent>
                    <SelectGroup>
                        <SelectLabel>Mammals</SelectLabel>
                        <SelectItem Value="@("cat")" Text="Cat" TValue="string">Cat</SelectItem>
                        <SelectItem Value="@("dog")" Text="Dog" TValue="string">Dog</SelectItem>
                        <SelectItem Value="@("elephant")" Text="Elephant" TValue="string">Elephant</SelectItem>
                    </SelectGroup>
                    <SelectGroup>
                        <SelectLabel>Birds</SelectLabel>
                        <SelectItem Value="@("eagle")" Text="Eagle" TValue="string">Eagle</SelectItem>
                        <SelectItem Value="@("parrot")" Text="Parrot" TValue="string">Parrot</SelectItem>
                        <SelectItem Value="@("penguin")" Text="Penguin" TValue="string">Penguin</SelectItem>
                    </SelectGroup>
                    <SelectGroup>
                        <SelectLabel>Reptiles</SelectLabel>
                        <SelectItem Value="@("crocodile")" Text="Crocodile" TValue="string">Crocodile</SelectItem>
                        <SelectItem Value="@("snake")" Text="Snake" TValue="string">Snake</SelectItem>
                        <SelectItem Value="@("turtle")" Text="Turtle" TValue="string">Turtle</SelectItem>
                    </SelectGroup>
                </SelectContent>
            </Select>

            @if (!string.IsNullOrEmpty(selectedAnimal))
            {
                <p class="text-sm">Selected: <strong>@selectedAnimal</strong></p>
            }
        </div>
    </section>

    <!-- Scrollable Long List -->
    <section class="space-y-4">
        <h2 class="text-2xl font-semibold">Scrollable Long List</h2>
        <p class="text-sm text-muted-foreground">
            Handle many options with automatic scrolling (max-h-60).
        </p>

        <div class="flex items-center gap-4">
            <Select @bind-Value="selectedCountry" TValue="string" Class="w-[280px]">
                <SelectTrigger>
                    <SelectValue Placeholder="Select a country" />
                </SelectTrigger>
                <SelectContent>
                    @foreach (var country in countries)
                    {
                        <SelectItem Value="@country" TValue="string">@country</SelectItem>
                    }
                </SelectContent>
            </Select>

            @if (!string.IsNullOrEmpty(selectedCountry))
            {
                <p class="text-sm">Selected: <strong>@selectedCountry</strong></p>
            }
        </div>
    </section>

    <!-- Generic Type Example -->
    <section class="space-y-4">
        <h2 class="text-2xl font-semibold">Generic Type Support</h2>
        <p class="text-sm text-muted-foreground">
            Select component supports generic types (int, enum, custom types).
        </p>

        <div class="flex items-center gap-4">
            <Select @bind-Value="selectedNumber" TValue="int" Class="w-[280px]">
                <SelectTrigger>
                    <SelectValue Placeholder="Select a number" />
                </SelectTrigger>
                <SelectContent>
                    <SelectItem Value="1" Text="One" TValue="int">One</SelectItem>
                    <SelectItem Value="2" Text="Two" TValue="int">Two</SelectItem>
                    <SelectItem Value="3" Text="Three" TValue="int">Three</SelectItem>
                    <SelectItem Value="4" Text="Four" TValue="int">Four</SelectItem>
                    <SelectItem Value="5" Text="Five" TValue="int">Five</SelectItem>
                </SelectContent>
            </Select>

            @if (selectedNumber > 0)
            {
                <p class="text-sm">Selected: <strong>@selectedNumber</strong></p>
            }
        </div>
    </section>

    <!-- Form Validation with EditForm -->
    <section class="space-y-4">
        <h2 class="text-2xl font-semibold">Form Validation</h2>
        <p class="text-sm text-muted-foreground">
            Select integrates with Blazor's EditForm and EditContext for model validation.
            Use <code class="text-xs bg-muted px-1 py-0.5 rounded">@@bind-Value</code> within an EditForm and
            validation errors will automatically apply error styling via <code class="text-xs bg-muted px-1 py-0.5 rounded">aria-invalid</code>.
        </p>

        <EditForm Model="selectFormModel" OnValidSubmit="HandleSelectFormSubmit" class="max-w-md space-y-4">
            <DataAnnotationsValidator />

            <div class="space-y-2">
                <label class="text-sm font-medium">Favorite Fruit</label>
                <Select @bind-Value="selectFormModel.Fruit" TValue="string" Class="w-[280px]">
                    <SelectTrigger>
                        <SelectValue Placeholder="Select a fruit" />
                    </SelectTrigger>
                    <SelectContent>
                        <SelectItem Value="@("apple")" Text="Apple" TValue="string">Apple</SelectItem>
                        <SelectItem Value="@("banana")" Text="Banana" TValue="string">Banana</SelectItem>
                        <SelectItem Value="@("blueberry")" Text="Blueberry" TValue="string">Blueberry</SelectItem>
                        <SelectItem Value="@("grapes")" Text="Grapes" TValue="string">Grapes</SelectItem>
                        <SelectItem Value="@("pineapple")" Text="Pineapple" TValue="string">Pineapple</SelectItem>
                    </SelectContent>
                </Select>
                <ValidationMessage For="@(() => selectFormModel.Fruit)" class="text-sm text-destructive" />
            </div>

            <div class="flex gap-4">
                <Button Type="ButtonType.Submit" Variant="ButtonVariant.Default">Submit</Button>
                <Button Type="ButtonType.Button" Variant="ButtonVariant.Outline" OnClick="ResetSelectForm">Reset</Button>
            </div>

            @if (!string.IsNullOrEmpty(selectFormMessage))
            {
                <div class="p-4 bg-card rounded-lg border">
                    <p class="text-sm">@selectFormMessage</p>
                </div>
            }
        </EditForm>
    </section>
</div>

@code {
    private string? selectedFruit;
    private string? selectedAnimal;
    private string? selectedCountry;
    private int selectedNumber;

    private readonly string[] countries = new[]
    {
        "Afghanistan", "Albania", "Algeria", "Andorra", "Angola",
        "Argentina", "Armenia", "Australia", "Austria", "Azerbaijan",
        "Bahamas", "Bahrain", "Bangladesh", "Barbados", "Belarus",
        "Belgium", "Belize", "Benin", "Bhutan", "Bolivia",
        "Bosnia and Herzegovina", "Botswana", "Brazil", "Brunei", "Bulgaria",
        "Burkina Faso", "Burundi", "Cambodia", "Cameroon", "Canada",
        "Cape Verde", "Central African Republic", "Chad", "Chile", "China",
        "Colombia", "Comoros", "Congo", "Costa Rica", "Croatia",
        "Cuba", "Cyprus", "Czech Republic", "Denmark", "Djibouti",
        "Dominica", "Dominican Republic", "East Timor", "Ecuador", "Egypt"
    };

    private SelectFormModel selectFormModel = new();
    private string? selectFormMessage;

    private void HandleSelectFormSubmit()
    {
        selectFormMessage = $"Form submitted! Fruit: {selectFormModel.Fruit}";
    }

    private void ResetSelectForm()
    {
        selectFormModel = new();
        selectFormMessage = null;
    }

    private class SelectFormModel
    {
        [Required(ErrorMessage = "Please select a fruit.")]
        public string? Fruit { get; set; }
    }
}
