# Rich Text Editor Component

WYSIWYG rich text editor built on Quill.js v2 with custom Blazor toolbar and HTML/Delta output.

---

## Overview

The RichTextEditor component provides a visual rich text editing experience using Quill.js v2 in headless mode with a custom Blazor toolbar. It outputs both HTML and Delta (Quill's native JSON format) for maximum flexibility.

**Features:**
- Built on Quill.js v2 (industry-standard rich text editor)
- Headless mode with custom Blazor toolbar using BlazorUI components
- Toolbar presets (None, Simple, Standard, Full, Custom)
- Two-way binding for HTML (@bind-Value) and Delta (@bind-DeltaValue)
- Keyboard shortcuts (Ctrl+B, Ctrl+I, Ctrl+U)
- Headers (H1, H2, H3)
- Bold, italic, underline, strikethrough
- Bullet and numbered lists
- Blockquote and code blocks
- Link insertion with BlazorUI Dialog
- Configurable height (min, max, or fixed)
- Dark mode compatible
- Full accessibility support

---

## Package

- **Package:** BlazorUI.Components
- **Namespace:** BlazorUI.Components.RichTextEditor
- **Source:** https://github.com/blazorui-net/ui/tree/main/src/BlazorUI.Components/Components/RichTextEditor
- **Dependencies:** Quill.js v2 (CDN)

---

## Installation

```bash
dotnet add package BlazorUI.Components
```

Add Quill.js to your `App.razor` or `_Host.cshtml`:

```html
<link href="https://cdn.jsdelivr.net/npm/quill@2/dist/quill.core.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/quill@2/dist/quill.js"></script>
```

Add to `_Imports.razor`:

```razor
@using BlazorUI.Components.RichTextEditor
```

---

## API Reference

### Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `Value` | `string?` | `null` | HTML content (supports @bind-Value) |
| `ValueChanged` | `EventCallback<string?>` | - | Callback on HTML value change |
| `DeltaValue` | `string?` | `null` | Delta JSON content (supports @bind-DeltaValue) |
| `DeltaValueChanged` | `EventCallback<string?>` | - | Callback on Delta value change |
| `Toolbar` | `ToolbarPreset` | `Standard` | Toolbar configuration preset |
| `ToolbarContent` | `RenderFragment?` | `null` | Custom toolbar content |
| `Placeholder` | `string?` | `null` | Placeholder text when empty |
| `Disabled` | `bool` | `false` | Whether the editor is disabled |
| `ReadOnly` | `bool` | `false` | Whether the editor is read-only |
| `Class` | `string?` | `null` | Additional CSS classes |
| `Id` | `string?` | `null` | HTML id attribute |
| `MinHeight` | `string` | `"150px"` | Minimum height of editor |
| `MaxHeight` | `string?` | `null` | Maximum height before scrollbar |
| `Height` | `string?` | `null` | Fixed height (overrides Min/Max) |
| `AriaLabel` | `string?` | `null` | ARIA label for accessibility |
| `AriaDescribedBy` | `string?` | `null` | ID of describing element |
| `AriaInvalid` | `bool?` | `null` | Whether value is invalid |

### Event Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `OnTextChange` | `EventCallback<TextChangeEventArgs>` | Fired when content changes |
| `OnSelectionChange` | `EventCallback<SelectionChangeEventArgs>` | Fired when selection changes |
| `OnFocus` | `EventCallback` | Fired when editor gains focus |
| `OnBlur` | `EventCallback` | Fired when editor loses focus |

### Toolbar Presets

| Preset | Features |
|--------|----------|
| `None` | No toolbar, plain editor |
| `Simple` | Bold, Italic, Underline, Bullet List, Ordered List |
| `Standard` | Simple + Header dropdown, Strikethrough, Link |
| `Full` | Standard + Blockquote, Code Block |
| `Custom` | User provides ToolbarContent |

### Public Methods

| Method | Returns | Description |
|--------|---------|-------------|
| `FocusAsync()` | `Task` | Focus the editor |
| `BlurAsync()` | `Task` | Remove focus from editor |
| `GetSelectionAsync()` | `Task<EditorRange?>` | Get current selection |
| `SetSelectionAsync(int index, int length)` | `Task` | Set selection range |
| `FormatAsync(string name, object? value)` | `Task` | Apply formatting |
| `GetTextAsync()` | `Task<string>` | Get plain text content |
| `GetLengthAsync()` | `Task<int>` | Get content length |
| `GetHtmlAsync()` | `Task<string>` | Get HTML content |
| `SetHtmlAsync(string? html)` | `Task` | Set HTML content |
| `GetDeltaAsync()` | `Task<string>` | Get Delta JSON content |
| `SetDeltaAsync(string? deltaJson)` | `Task` | Set Delta content |

### Event Args

#### TextChangeEventArgs

| Property | Type | Description |
|----------|------|-------------|
| `Delta` | `string?` | JSON delta of the change |
| `OldDelta` | `string?` | Previous delta |
| `Source` | `string?` | Change source ("user", "api") |
| `Html` | `string?` | Current HTML content |
| `Text` | `string?` | Current plain text |
| `Length` | `int` | Content length |

#### SelectionChangeEventArgs

| Property | Type | Description |
|----------|------|-------------|
| `Range` | `EditorRange?` | Current selection range |
| `OldRange` | `EditorRange?` | Previous selection |
| `Source` | `string?` | Change source |
| `Format` | `Dictionary<string, object?>?` | Active formats at selection |

#### EditorRange

| Property | Type | Description |
|----------|------|-------------|
| `Index` | `int` | Start position |
| `Length` | `int` | Selection length |

---

## Basic Usage

```razor
@using BlazorUI.Components.RichTextEditor

<RichTextEditor @bind-Value="content" Placeholder="Start typing..." />

@code {
    private string? content;
}
```

---

## Examples

### Toolbar Presets

```razor
@* Simple toolbar - basic formatting *@
<RichTextEditor @bind-Value="content1" Toolbar="ToolbarPreset.Simple" />

@* Standard toolbar (default) - includes headers and links *@
<RichTextEditor @bind-Value="content2" Toolbar="ToolbarPreset.Standard" />

@* Full toolbar - all formatting options *@
<RichTextEditor @bind-Value="content3" Toolbar="ToolbarPreset.Full" />

@* No toolbar *@
<RichTextEditor @bind-Value="content4" Toolbar="ToolbarPreset.None" />

@code {
    private string? content1, content2, content3, content4;
}
```

### With Label

```razor
@using BlazorUI.Components.RichTextEditor
@using BlazorUI.Components.Label

<div class="space-y-2">
    <Label For="description-editor">Description</Label>
    <RichTextEditor
        Id="description-editor"
        @bind-Value="description"
        Placeholder="Enter a description..." />
</div>

@code {
    private string? description;
}
```

### Pre-populated Content

```razor
<RichTextEditor @bind-Value="content" />

@code {
    private string content = @"<h2>Welcome</h2>
<p>This is <strong>bold</strong> and this is <em>italic</em> text.</p>
<ul>
<li>First item</li>
<li>Second item</li>
</ul>";
}
```

### Height Control

```razor
@* Maximum height with scrollbar *@
<RichTextEditor
    @bind-Value="content1"
    MaxHeight="200px"
    Placeholder="Content will scroll after 200px..." />

@* Fixed height *@
<RichTextEditor
    @bind-Value="content2"
    Height="150px"
    Placeholder="Fixed height editor..." />

@* Custom minimum height *@
<RichTextEditor
    @bind-Value="content3"
    MinHeight="300px"
    Placeholder="Taller editor..." />

@code {
    private string? content1, content2, content3;
}
```

### Disabled and Read-Only States

```razor
@* Disabled - no editing, toolbar disabled *@
<RichTextEditor
    Value="<p>This editor is <strong>disabled</strong>.</p>"
    Disabled="true" />

@* Read-only - content visible but not editable *@
<RichTextEditor
    Value="<p>This content is <strong>read-only</strong>.</p>"
    ReadOnly="true" />
```

### With Delta Binding

```razor
@using BlazorUI.Components.RichTextEditor

<RichTextEditor
    @bind-Value="htmlContent"
    @bind-DeltaValue="deltaContent" />

<div class="mt-4 grid grid-cols-2 gap-4">
    <div>
        <h4>HTML Output</h4>
        <pre class="text-xs bg-muted p-2 rounded">@htmlContent</pre>
    </div>
    <div>
        <h4>Delta Output</h4>
        <pre class="text-xs bg-muted p-2 rounded">@deltaContent</pre>
    </div>
</div>

@code {
    private string? htmlContent;
    private string? deltaContent;
}
```

### Event Handling

```razor
<RichTextEditor
    @bind-Value="content"
    OnTextChange="HandleTextChange"
    OnSelectionChange="HandleSelectionChange"
    OnFocus="HandleFocus"
    OnBlur="HandleBlur" />

<p>Character count: @charCount</p>
<p>Current format: @currentFormat</p>

@code {
    private string? content;
    private int charCount;
    private string currentFormat = "none";

    private void HandleTextChange(TextChangeEventArgs args)
    {
        charCount = args.Length;
    }

    private void HandleSelectionChange(SelectionChangeEventArgs args)
    {
        if (args.Format != null)
        {
            var formats = new List<string>();
            if (args.Format.ContainsKey("bold")) formats.Add("bold");
            if (args.Format.ContainsKey("italic")) formats.Add("italic");
            currentFormat = formats.Count > 0 ? string.Join(", ", formats) : "none";
        }
    }

    private void HandleFocus() => Console.WriteLine("Editor focused");
    private void HandleBlur() => Console.WriteLine("Editor blurred");
}
```

### Form Integration

```razor
@using BlazorUI.Components.RichTextEditor
@using BlazorUI.Components.Card
@using BlazorUI.Components.Button
@using BlazorUI.Components.Label

<Card>
    <CardHeader>
        <CardTitle>Submit Feedback</CardTitle>
        <CardDescription>Share your thoughts using rich text formatting.</CardDescription>
    </CardHeader>
    <CardContent Class="space-y-4">
        <div class="space-y-2">
            <Label For="feedback-editor">Your Feedback</Label>
            <RichTextEditor
                @bind-Value="feedback"
                Id="feedback-editor"
                Toolbar="ToolbarPreset.Standard"
                Placeholder="What's on your mind?" />
        </div>
    </CardContent>
    <CardFooter>
        <Button OnClick="HandleSubmit" Disabled="@string.IsNullOrWhiteSpace(feedback)">
            Submit Feedback
        </Button>
    </CardFooter>
</Card>

@code {
    private string? feedback;

    private void HandleSubmit()
    {
        // Process feedback HTML
    }
}
```

---

## Toolbar Features

### Standard Toolbar Layout

| Section | Controls |
|---------|----------|
| Headers | Dropdown (Normal, H1, H2, H3) |
| Text Style | Bold, Italic, Underline, Strikethrough |
| Lists | Bullet list, Numbered list |
| Links | Insert/Edit link (opens dialog) |
| Blocks | Blockquote, Code block (Full preset only) |

### Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| Ctrl+B | Bold |
| Ctrl+I | Italic |
| Ctrl+U | Underline |

---

## HTML Output

The editor generates semantic HTML using Quill's getSemanticHTML():

| Formatting | HTML Output |
|------------|-------------|
| Bold | `<strong>text</strong>` |
| Italic | `<em>text</em>` |
| Underline | `<u>text</u>` |
| Strikethrough | `<s>text</s>` |
| Header 1 | `<h1>text</h1>` |
| Header 2 | `<h2>text</h2>` |
| Header 3 | `<h3>text</h3>` |
| Bullet List | `<ul><li>item</li></ul>` |
| Numbered List | `<ol><li>item</li></ol>` |
| Blockquote | `<blockquote>text</blockquote>` |
| Code Block | `<pre class="ql-syntax">code</pre>` |
| Link | `<a href="url">text</a>` |

---

## Accessibility

### Label Association

```razor
<Label For="editor">Content</Label>
<RichTextEditor Id="editor" @bind-Value="content" AriaLabel="Content editor" />
```

### Help Text

```razor
<RichTextEditor
    @bind-Value="content"
    AriaDescribedBy="editor-help" />
<p id="editor-help" class="text-sm text-muted-foreground">
    Use the toolbar to format your text or keyboard shortcuts (Ctrl+B for bold).
</p>
```

### Error State

```razor
<RichTextEditor
    @bind-Value="content"
    AriaInvalid="@hasError"
    AriaDescribedBy="editor-error" />
@if (hasError)
{
    <p id="editor-error" class="text-sm text-destructive">
        Content is required
    </p>
}
```

---

## Common Patterns

### Blog Post Editor

```razor
@using BlazorUI.Components.RichTextEditor
@using BlazorUI.Components.Input
@using BlazorUI.Components.Label
@using BlazorUI.Components.Button

<div class="space-y-4">
    <div class="space-y-2">
        <Label For="title">Post Title</Label>
        <Input Id="title" @bind-Value="title" Placeholder="Enter title..." />
    </div>

    <div class="space-y-2">
        <Label For="content">Content</Label>
        <RichTextEditor
            Id="content"
            @bind-Value="content"
            Toolbar="ToolbarPreset.Full"
            MinHeight="300px"
            Placeholder="Write your post..." />
    </div>

    <Button OnClick="SavePost">Publish</Button>
</div>

@code {
    private string? title;
    private string? content;

    private void SavePost()
    {
        // Save title and HTML content
    }
}
```

### Comment System

```razor
<RichTextEditor
    @bind-Value="comment"
    Toolbar="ToolbarPreset.Simple"
    Height="100px"
    Placeholder="Write a comment..." />
<div class="flex justify-end mt-2">
    <Button Size="ButtonSize.Small" OnClick="PostComment">
        Post Comment
    </Button>
</div>

@code {
    private string? comment;

    private void PostComment()
    {
        // Submit comment
        comment = null;
    }
}
```

### Programmatic Content Control

```razor
@using BlazorUI.Components.RichTextEditor
@using BlazorUI.Components.Button

<RichTextEditor @ref="editor" @bind-Value="content" />

<div class="flex gap-2 mt-2">
    <Button OnClick="InsertTemplate">Insert Template</Button>
    <Button OnClick="ClearContent" Variant="ButtonVariant.Outline">Clear</Button>
    <Button OnClick="FocusEditor" Variant="ButtonVariant.Ghost">Focus</Button>
</div>

@code {
    private RichTextEditor? editor;
    private string? content;

    private async Task InsertTemplate()
    {
        await editor!.SetHtmlAsync("<h2>Template</h2><p>Start editing here...</p>");
    }

    private async Task ClearContent()
    {
        await editor!.SetHtmlAsync("");
    }

    private async Task FocusEditor()
    {
        await editor!.FocusAsync();
    }
}
```

---

## Troubleshooting

### Issue: Quill not loading

**Solution:** Ensure Quill.js is loaded in your HTML head before the Blazor script:

```html
<link href="https://cdn.jsdelivr.net/npm/quill@2/dist/quill.core.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/quill@2/dist/quill.js"></script>
```

### Issue: Content not updating

**Solution:** Ensure you're using `@bind-Value` for two-way binding:

```razor
<RichTextEditor @bind-Value="content" />
```

### Issue: Toolbar buttons not responding

**Solution:** Check that the editor is not disabled and has focus. The toolbar state syncs with the current selection.

### Issue: Link dialog not appearing

**Solution:** Select text first, then click the link button. Links can only be applied to selected text.

---

## Related Components

- **MarkdownEditor** - llms/components/markdown-editor.txt (for Markdown syntax editing)
- **Textarea** - llms/components/textarea.txt (for plain text)
- **Input** - llms/components/input.txt (for single-line text)
- **Label** - llms/components/label.txt (for accessibility)
- **Field** - llms/components/field.txt (for form layouts)
- **Dialog** - llms/components/dialog.txt (used for link input)

## Comparison with MarkdownEditor

| Feature | RichTextEditor | MarkdownEditor |
|---------|----------------|----------------|
| Input Style | WYSIWYG | Plain text + Preview |
| Output | HTML + Delta | Markdown |
| Engine | Quill.js v2 | Custom |
| Headers | H1-H3 | H1-H6 |
| Code Blocks | Yes | Yes |
| Blockquote | Yes | Yes |
| Links | Dialog prompt | Markdown syntax |
| Best For | Non-technical users | Developers |

---

**Last Updated:** 2026-01-23
