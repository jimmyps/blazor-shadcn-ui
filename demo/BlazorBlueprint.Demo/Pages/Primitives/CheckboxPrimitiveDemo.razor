@page "/primitives/checkbox"
@using BlazorBlueprint.Components.Kbd

<PageTitle>Checkbox Primitive - Blazor Blueprint</PageTitle>

<div class="space-y-8 max-w-4xl">
    <div>
        <div class="space-y-3">
            <h1 class="text-4xl font-bold tracking-tight">Checkbox Primitive</h1>
            <p class="text-xl text-muted-foreground">
                Unstyled, accessible primitive component for building custom checkboxes.
            </p>
        </div>
    </div>

    <div class="space-y-6">
        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Basic Headless Primitive</h2>
                <p class="text-muted-foreground">
                    The primitive provides behavior and accessibility without styling.
                </p>
            </div>

            <div class="rounded-lg border bg-card p-6 max-w-md">
                <div class="flex items-center gap-3">
                    <BlazorBlueprint.Primitives.Checkbox.Checkbox @bind-Checked="basicChecked" Id="basic" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center">
                        @if (basicChecked)
                        {
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        }
                    </BlazorBlueprint.Primitives.Checkbox.Checkbox>
                    <label for="basic">Unstyled primitive checkbox</label>
                </div>
                <p class="text-sm text-muted-foreground mt-2">
                    State: <strong>@(basicChecked ? "Checked" : "Unchecked")</strong>
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Controlled State</h2>
                <p class="text-muted-foreground">
                    Control the primitive state externally.
                </p>
            </div>

            <div class="space-y-4">
                <div class="flex gap-2">
                    <button @onclick="@(() => controlledChecked = true)"
                            class="px-3 py-2 border rounded text-sm">
                        Check
                    </button>
                    <button @onclick="@(() => controlledChecked = false)"
                            class="px-3 py-2 border rounded text-sm">
                        Uncheck
                    </button>
                </div>

                <div class="rounded-lg border bg-card p-6 max-w-md">
                    <div class="flex items-center gap-3">
                        <BlazorBlueprint.Primitives.Checkbox.Checkbox @bind-Checked="controlledChecked" Id="controlled" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center">
                            @if (controlledChecked)
                            {
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            }
                        </BlazorBlueprint.Primitives.Checkbox.Checkbox>
                        <label for="controlled">
                            Controlled Checkbox (State: @(controlledChecked ? "Checked" : "Unchecked"))
                        </label>
                    </div>
                </div>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Indeterminate State</h2>
                <p class="text-muted-foreground">
                    Useful for "select all" scenarios when only some items are selected.
                </p>
            </div>

            <div class="rounded-lg border bg-card p-6 max-w-md">
                <div class="space-y-3">
                    <div class="flex items-center gap-3">
                        <BlazorBlueprint.Primitives.Checkbox.Checkbox Checked="@allChecked" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center"
                                           Indeterminate="@indeterminate"
                                           CheckedChanged="@HandleParentChanged"
                                           Id="parent">
                            @if (allChecked)
                            {
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            }
                            else if (indeterminate)
                            {
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                            }
                        </BlazorBlueprint.Primitives.Checkbox.Checkbox>
                        <label for="parent" class="font-medium">Select All</label>
                    </div>
                    <div class="ml-6 space-y-2">
                        <div class="flex items-center gap-3">
                            <BlazorBlueprint.Primitives.Checkbox.Checkbox Checked="@child1" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center" CheckedChanged="@(v => { child1 = v; HandleChildChanged(); })" Id="child1">
                                @if (child1)
                                {
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                }
                            </BlazorBlueprint.Primitives.Checkbox.Checkbox>
                            <label for="child1">Option 1</label>
                        </div>
                        <div class="flex items-center gap-3">
                            <BlazorBlueprint.Primitives.Checkbox.Checkbox Checked="@child2" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center" CheckedChanged="@(v => { child2 = v; HandleChildChanged(); })" Id="child2">
                                @if (child2)
                                {
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                }
                            </BlazorBlueprint.Primitives.Checkbox.Checkbox>
                            <label for="child2">Option 2</label>
                        </div>
                        <div class="flex items-center gap-3">
                            <BlazorBlueprint.Primitives.Checkbox.Checkbox Checked="@child3" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center" CheckedChanged="@(v => { child3 = v; HandleChildChanged(); })" Id="child3">
                                @if (child3)
                                {
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                }
                            </BlazorBlueprint.Primitives.Checkbox.Checkbox>
                            <label for="child3">Option 3</label>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Accessibility Features</h2>
                <p class="text-muted-foreground">
                    Built-in accessibility features following WAI-ARIA design patterns.
                </p>
            </div>

            <div class="rounded-lg border p-6 space-y-3 bg-muted/50">
                <div>
                    <h3 class="font-semibold mb-2">ARIA Attributes</h3>
                    <ul class="space-y-2 text-sm text-muted-foreground">
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span><code class="text-xs bg-muted px-1 py-0.5 rounded">role="checkbox"</code> for screen readers</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span><code class="text-xs bg-muted px-1 py-0.5 rounded">aria-checked</code> indicates checked state (true/false/mixed)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span><code class="text-xs bg-muted px-1 py-0.5 rounded">data-state</code> attribute for CSS styling (checked|unchecked|indeterminate)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span><code class="text-xs bg-muted px-1 py-0.5 rounded">disabled</code> attribute for disabled state</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span>Focus management with visible focus indicators</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Keyboard Shortcuts</h2>
                <p class="text-muted-foreground">
                    Navigate and interact with checkboxes using keyboard.
                </p>
            </div>

            <div class="rounded-lg border p-6 space-y-3 bg-muted/50">
                <div class="grid gap-3">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium">Navigate to checkbox</span>
                        <Kbd>Tab</Kbd>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium">Toggle checkbox</span>
                        <Kbd>Space</Kbd>
                    </div>
                </div>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">API Reference</h2>
                <p class="text-muted-foreground">
                    Component properties and parameters.
                </p>
            </div>

            <div class="space-y-4">
                <div class="rounded-lg border p-4">
                    <h3 class="font-semibold mb-3">CheckboxPrimitive</h3>
                    <div class="space-y-3 text-sm">
                        <div>
                            <code class="text-xs bg-muted px-1 py-0.5 rounded">Checked</code>
                            <p class="text-muted-foreground mt-1">
                                <strong>Type:</strong> <code>bool</code><br/>
                                <strong>Default:</strong> <code>false</code><br/>
                                Controls whether the checkbox is checked. Supports two-way binding with @@bind-Checked.
                            </p>
                        </div>
                        <div>
                            <code class="text-xs bg-muted px-1 py-0.5 rounded">CheckedChanged</code>
                            <p class="text-muted-foreground mt-1">
                                <strong>Type:</strong> <code>EventCallback&lt;bool&gt;</code><br/>
                                Callback invoked when the checked state changes.
                            </p>
                        </div>
                        <div>
                            <code class="text-xs bg-muted px-1 py-0.5 rounded">Indeterminate</code>
                            <p class="text-muted-foreground mt-1">
                                <strong>Type:</strong> <code>bool</code><br/>
                                <strong>Default:</strong> <code>false</code><br/>
                                Sets the checkbox to indeterminate state (for "select all" scenarios). Sets aria-checked="mixed".
                            </p>
                        </div>
                        <div>
                            <code class="text-xs bg-muted px-1 py-0.5 rounded">IndeterminateChanged</code>
                            <p class="text-muted-foreground mt-1">
                                <strong>Type:</strong> <code>EventCallback&lt;bool&gt;</code><br/>
                                Callback invoked when the indeterminate state changes.
                            </p>
                        </div>
                        <div>
                            <code class="text-xs bg-muted px-1 py-0.5 rounded">Disabled</code>
                            <p class="text-muted-foreground mt-1">
                                <strong>Type:</strong> <code>bool</code><br/>
                                <strong>Default:</strong> <code>false</code><br/>
                                Prevents toggling when true.
                            </p>
                        </div>
                        <div>
                            <code class="text-xs bg-muted px-1 py-0.5 rounded">Id</code>
                            <p class="text-muted-foreground mt-1">
                                <strong>Type:</strong> <code>string?</code><br/>
                                Unique identifier for the checkbox element. Used for label association.
                            </p>
                        </div>
                        <div>
                            <code class="text-xs bg-muted px-1 py-0.5 rounded">ChildContent</code>
                            <p class="text-muted-foreground mt-1">
                                <strong>Type:</strong> <code>RenderFragment?</code><br/>
                                Content rendered inside the checkbox (typically a checkmark icon).
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">When to Use Primitives</h2>
                <p class="text-muted-foreground">
                    Choose between primitives and styled components based on your needs.
                </p>
            </div>

            <div class="grid md:grid-cols-2 gap-4">
                <div class="rounded-lg border p-4 space-y-3">
                    <h3 class="font-semibold text-primary">Use Checkbox Primitive</h3>
                    <ul class="space-y-2 text-sm text-muted-foreground">
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span>Building a custom design system</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span>Need complete control over styling</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span>Want to apply your own CSS framework</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-green-600 dark:text-green-400">✓</span>
                            <span>Creating unique visual designs</span>
                        </li>
                    </ul>
                </div>

                <div class="rounded-lg border p-4 space-y-3">
                    <h3 class="font-semibold text-primary">Use Styled Component</h3>
                    <ul class="space-y-2 text-sm text-muted-foreground">
                        <li class="flex items-start gap-2">
                            <span class="text-blue-600 dark:text-blue-400">●</span>
                            <span>Want shadcn/ui design out of the box</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-blue-600 dark:text-blue-400">●</span>
                            <span>Need quick implementation</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-blue-600 dark:text-blue-400">●</span>
                            <span>Like the default styling</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-blue-600 dark:text-blue-400">●</span>
                            <span>Prefer convention over configuration</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>
    </div>
</div>

@code {
    private bool basicChecked = false;
    private bool controlledChecked = false;

    // Indeterminate state demo
    private bool child1 = true;
    private bool child2 = false;
    private bool child3 = true;
    private bool allChecked = false;
    private bool indeterminate = true;

    protected override void OnInitialized()
    {
        UpdateParentState();
    }

    private void HandleChildChanged()
    {
        UpdateParentState();
    }

    private void HandleParentChanged(bool value)
    {
        allChecked = value;
        indeterminate = false;
        child1 = value;
        child2 = value;
        child3 = value;
    }

    private void UpdateParentState()
    {
        var checkedCount = (child1 ? 1 : 0) + (child2 ? 1 : 0) + (child3 ? 1 : 0);

        if (checkedCount == 0)
        {
            allChecked = false;
            indeterminate = false;
        }
        else if (checkedCount == 3)
        {
            allChecked = true;
            indeterminate = false;
        }
        else
        {
            allChecked = false;
            indeterminate = true;
        }
    }
}
