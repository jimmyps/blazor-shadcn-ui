@page "/primitives/select"
@using BlazorBlueprint.Primitives.Select
@using BlazorBlueprint.Components.Kbd

<PageTitle>Select Primitive - Blazor Blueprint</PageTitle>

<div class="space-y-8 max-w-4xl">
    <div class="space-y-8 max-w-4xl">
        <!-- Header -->
        <div class="space-y-2">
            <h1 class="text-4xl font-bold tracking-tight">Select Primitive</h1>
            <p class="text-lg text-muted-foreground">
                Headless, unstyled select component with full keyboard navigation and ARIA support.
            </p>
        </div>

        <!-- Features -->
        <div class="rounded-lg border border-border bg-card p-6">
            <h2 class="text-xl font-semibold mb-4">Features</h2>
            <ul class="space-y-2 text-sm text-muted-foreground list-disc list-inside">
                <li>Generic TValue support for type-safe values</li>
                <li>Full keyboard navigation (Arrow keys, Home, End, Enter, Space, Escape)</li>
                <li>Mouse hover integration with keyboard focus</li>
                <li>Controlled and uncontrolled modes</li>
                <li>ARIA attributes (role, aria-expanded, aria-activedescendant)</li>
                <li>Click-outside to close</li>
                <li>Item registration for navigation</li>
                <li>Disabled state support</li>
            </ul>
        </div>

        <!-- Basic Example -->
        <div class="space-y-6">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold tracking-tight">Basic Example</h2>
                <p class="text-sm text-muted-foreground">
                    Minimal unstyled primitive (add your own styles)
                </p>
            </div>
            <div class="rounded-lg border border-border bg-card p-6">
                <div class="w-[280px]">
                    <BlazorBlueprint.Primitives.Select.Select TValue="string" @bind-Value="basicValue" DisplayTextSelector="@GetFruitDisplayText" style="position: relative;">
                        <BlazorBlueprint.Primitives.Select.SelectTrigger TValue="string" class="flex items-center justify-between w-full px-3 py-2 border border-input rounded-md bg-background">
                            <span>Selected: @GetFruitDisplayText(basicValue)</span>
                            <span>‚ñº</span>
                        </BlazorBlueprint.Primitives.Select.SelectTrigger>
                        <BlazorBlueprint.Primitives.Select.SelectContent TValue="string" class="z-50 mt-1 w-full border border-border rounded-md bg-popover shadow-md">
                            <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("apple")" TextValue="Apple" class="px-3 py-2 cursor-pointer hover:bg-accent">
                                Apple
                            </BlazorBlueprint.Primitives.Select.SelectItem>
                            <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("banana")" TextValue="Banana" class="px-3 py-2 cursor-pointer hover:bg-accent">
                                Banana
                            </BlazorBlueprint.Primitives.Select.SelectItem>
                            <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("orange")" TextValue="Orange" class="px-3 py-2 cursor-pointer hover:bg-accent">
                                Orange
                            </BlazorBlueprint.Primitives.Select.SelectItem>
                            <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("grape")" TextValue="Grape" class="px-3 py-2 cursor-pointer hover:bg-accent">
                                Grape
                            </BlazorBlueprint.Primitives.Select.SelectItem>
                        </BlazorBlueprint.Primitives.Select.SelectContent>
                    </BlazorBlueprint.Primitives.Select.Select>
                </div>
            </div>
        </div>

        <!-- Controlled Example -->
        <div class="space-y-6">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold tracking-tight">Controlled Example</h2>
                <p class="text-sm text-muted-foreground">
                    Parent component controls the selected value
                </p>
            </div>
            <div class="rounded-lg border border-border bg-card p-6">
                <div class="space-y-6">
                    <div class="w-[280px]">
                        <BlazorBlueprint.Primitives.Select.Select TValue="string" @bind-Value="controlledValue" style="position: relative;">
                            <BlazorBlueprint.Primitives.Select.SelectTrigger TValue="string" class="flex items-center justify-between w-full px-3 py-2 border border-input rounded-md bg-background">
                                <span>@(string.IsNullOrEmpty(controlledValue) ? "Select a fruit" : controlledValue)</span>
                                <span>‚ñº</span>
                            </BlazorBlueprint.Primitives.Select.SelectTrigger>
                            <BlazorBlueprint.Primitives.Select.SelectContent TValue="string" class="z-50 mt-1 w-full max-h-60 overflow-auto border border-border rounded-md bg-popover shadow-md">
                                <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("Strawberry")" class="px-3 py-2 cursor-pointer hover:bg-accent">
                                    üçì Strawberry
                                </BlazorBlueprint.Primitives.Select.SelectItem>
                                <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("Watermelon")" class="px-3 py-2 cursor-pointer hover:bg-accent">
                                    üçâ Watermelon
                                </BlazorBlueprint.Primitives.Select.SelectItem>
                                <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("Pineapple")" class="px-3 py-2 cursor-pointer hover:bg-accent">
                                    üçç Pineapple
                                </BlazorBlueprint.Primitives.Select.SelectItem>
                                <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("Mango")" class="px-3 py-2 cursor-pointer hover:bg-accent">
                                    ü•≠ Mango
                                </BlazorBlueprint.Primitives.Select.SelectItem>
                            </BlazorBlueprint.Primitives.Select.SelectContent>
                        </BlazorBlueprint.Primitives.Select.Select>
                    </div>
                    <div class="text-sm text-muted-foreground">
                        Current value: <span class="font-mono">@(string.IsNullOrEmpty(controlledValue) ? "null" : controlledValue)</span>
                    </div>
                    <button @onclick="@(() => controlledValue = "Mango")" class="px-4 py-2 text-sm border border-border rounded-md hover:bg-accent">
                        Set to Mango
                    </button>
                </div>
            </div>
        </div>

        <!-- Disabled State -->
        <div class="space-y-6">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold tracking-tight">Disabled State</h2>
                <p class="text-sm text-muted-foreground">
                    Select with disabled state
                </p>
            </div>
            <div class="rounded-lg border border-border bg-card p-6">
                <div class="w-[280px]">
                    <BlazorBlueprint.Primitives.Select.Select TValue="string" Disabled="true" DefaultValue="@("disabled")" style="position: relative;">
                        <BlazorBlueprint.Primitives.Select.SelectTrigger TValue="string" class="flex items-center justify-between w-full px-3 py-2 border border-input rounded-md bg-background opacity-50 cursor-not-allowed">
                            <span>Disabled Select</span>
                            <span>‚ñº</span>
                        </BlazorBlueprint.Primitives.Select.SelectTrigger>
                        <BlazorBlueprint.Primitives.Select.SelectContent TValue="string" class="z-50 mt-1 w-full border border-border rounded-md bg-popover shadow-md">
                            <BlazorBlueprint.Primitives.Select.SelectItem TValue="string" Value="@("disabled")" class="px-3 py-2">
                                This won't open
                            </BlazorBlueprint.Primitives.Select.SelectItem>
                        </BlazorBlueprint.Primitives.Select.SelectContent>
                    </BlazorBlueprint.Primitives.Select.Select>
                </div>
            </div>
        </div>

        <!-- Keyboard Navigation -->
        <div class="space-y-6">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold tracking-tight">Keyboard Navigation</h2>
                <p class="text-sm text-muted-foreground">
                    Full keyboard support with all standard keys
                </p>
            </div>
            <div class="rounded-lg border border-border bg-card p-6">
                <div class="space-y-6">
                    <div class="w-[280px]">
                        <BlazorBlueprint.Primitives.Select.Select TValue="int" @bind-Value="keyboardValue" style="position: relative;">
                            <BlazorBlueprint.Primitives.Select.SelectTrigger TValue="int" class="flex items-center justify-between w-full px-3 py-2 border border-input rounded-md bg-background">
                                <span>Item @keyboardValue</span>
                                <span>‚ñº</span>
                            </BlazorBlueprint.Primitives.Select.SelectTrigger>
                            <BlazorBlueprint.Primitives.Select.SelectContent TValue="int" class="z-50 mt-1 w-full max-h-60 overflow-auto border border-border rounded-md bg-popover shadow-md">
                                @for (int i = 1; i <= 10; i++)
                                {
                                    var value = i;
                                    <BlazorBlueprint.Primitives.Select.SelectItem TValue="int" Value="@value" class="px-3 py-2 cursor-pointer hover:bg-accent data-[focused=true]:bg-accent">
                                        Item @value
                                    </BlazorBlueprint.Primitives.Select.SelectItem>
                                }
                            </BlazorBlueprint.Primitives.Select.SelectContent>
                        </BlazorBlueprint.Primitives.Select.Select>
                    </div>
                    <div class="text-sm text-muted-foreground space-y-1">
                        <p><Kbd>‚Üë</Kbd> <Kbd>‚Üì</Kbd> Navigate items</p>
                        <p><Kbd>Home</Kbd> <Kbd>End</Kbd> First/Last item</p>
                        <p><Kbd>Enter</Kbd> <Kbd>Space</Kbd> Select item</p>
                        <p><Kbd>Esc</Kbd> Close dropdown</p>
                        <p><Kbd>Tab</Kbd> Close and move focus</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Reference -->
        <div class="space-y-6">
            <h2 class="text-2xl font-semibold tracking-tight">API Reference</h2>

            <div class="rounded-lg border border-border bg-card p-6">
                <h3 class="text-lg font-semibold mb-2">Select&lt;TValue&gt;</h3>
                <div class="text-sm text-muted-foreground space-y-2">
                    <p><code>Value</code> - Currently selected value (controlled)</p>
                    <p><code>ValueChanged</code> - Event callback when value changes</p>
                    <p><code>DefaultValue</code> - Initial value (uncontrolled)</p>
                    <p><code>Open</code> - Whether dropdown is open (controlled)</p>
                    <p><code>OpenChanged</code> - Event callback when open state changes</p>
                    <p><code>Disabled</code> - Whether select is disabled</p>
                </div>
            </div>

            <div class="rounded-lg border border-border bg-card p-6">
                <h3 class="text-lg font-semibold mb-2">SelectItem&lt;TValue&gt;</h3>
                <div class="text-sm text-muted-foreground space-y-2">
                    <p><code>Value</code> - Value this item represents (required)</p>
                    <p><code>TextValue</code> - Optional display text override</p>
                    <p><code>Disabled</code> - Whether this item is disabled</p>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private string? basicValue = "apple";
    private string? controlledValue = "";
    private int keyboardValue = 1;

    private string GetFruitDisplayText(string? value) => value switch
    {
        "apple" => "Apple",
        "banana" => "Banana",
        "orange" => "Orange",
        "grape" => "Grape",
        _ => value ?? ""
    };
}
