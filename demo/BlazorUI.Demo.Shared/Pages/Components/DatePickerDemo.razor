@page "/components/date-picker"
@using BlazorUI.Components.DatePicker
@using BlazorUI.Components.DateRangePicker
@using BlazorUI.Components.TimePicker
@using BlazorUI.Components.Calendar
@using BlazorUI.Components.Field

<PageTitle>DatePicker Component - BlazorUI</PageTitle>

<div class="space-y-8 max-w-4xl">
    <div>
        <div class="space-y-3">
            <h1 class="text-4xl font-bold tracking-tight">DatePicker Component</h1>
            <p class="text-xl text-muted-foreground">
                Date selection with a calendar in a popover. Pick a single date or a date range with full keyboard navigation.
            </p>
        </div>
    </div>

    <div class="space-y-6">
        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Default</h2>
                <p class="text-muted-foreground">
                    A basic date picker with calendar icon.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DatePicker @bind-SelectedDate="selectedDate1" />
                </div>
                <p class="text-sm text-muted-foreground">
                    Selected: @(selectedDate1?.ToString("D") ?? "None")
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">With Dropdown Icon</h2>
                <p class="text-muted-foreground">
                    Date picker with chevron-down icon on the right, no calendar icon on the left.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DatePicker @bind-SelectedDate="selectedDate1b"
                               ShowIcon="false"
                               ShowDropdownIcon="true" />
                </div>
                <p class="text-sm text-muted-foreground">
                    Selected: @(selectedDate1b?.ToString("D") ?? "None")
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Date Range Picker</h2>
                <p class="text-muted-foreground">
                    Select a date range with start and end dates displayed side-by-side.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DateRangePicker @bind-StartDate="startDate"
                                    @bind-EndDate="endDate"
                                    Placeholder="Select date range" />
                </div>
                <p class="text-sm text-muted-foreground">
                    From: @(startDate?.ToString("D") ?? "None")
                    <br />
                    To: @(endDate?.ToString("D") ?? "None")
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">With Date Constraints</h2>
                <p class="text-muted-foreground">
                    Limit selection to a specific date range.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DatePicker @bind-SelectedDate="selectedDate2"
                               MinDate="DateOnly.FromDateTime(DateTime.Today)"
                               MaxDate="DateOnly.FromDateTime(DateTime.Today.AddMonths(3))"
                               Placeholder="Pick a date (next 3 months)" />
                </div>
                <p class="text-sm text-muted-foreground">
                    Selected: @(selectedDate2?.ToString("D") ?? "None")
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Disable Weekends</h2>
                <p class="text-muted-foreground">
                    Disable specific dates with a custom function.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DatePicker @bind-SelectedDate="selectedDate3"
                               IsDateDisabled="IsWeekend"
                               Placeholder="Pick a weekday" />
                </div>
                <p class="text-sm text-muted-foreground">
                    Selected: @(selectedDate3?.ToString("D") ?? "None")
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Custom Format</h2>
                <p class="text-muted-foreground">
                    Display date with a custom format string.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DatePicker @bind-SelectedDate="selectedDate4"
                               DateFormat="yyyy-MM-dd"
                               Placeholder="YYYY-MM-DD" />
                </div>
                <p class="text-sm text-muted-foreground">
                    Selected: @(selectedDate4?.ToString("yyyy-MM-dd") ?? "None")
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Dropdown Mode</h2>
                <p class="text-muted-foreground">
                    Use dropdown selects for quick month and year navigation.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DatePicker @bind-SelectedDate="selectedDate5"
                               CaptionLayout="CalendarCaptionLayout.Dropdown"
                               Placeholder="Pick a date" />
                </div>
                <p class="text-sm text-muted-foreground">
                    Selected: @(selectedDate5?.ToString("D") ?? "None")
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">In a Form</h2>
                <p class="text-muted-foreground">
                    DatePicker integrated with form fields.
                </p>
            </div>

            <div class="flex flex-col gap-4 max-w-sm">
                <Field>
                    <FieldLabel>Date of Birth</FieldLabel>
                    <DatePicker @bind-SelectedDate="dateOfBirth"
                               MaxDate="DateOnly.FromDateTime(DateTime.Today)"
                               Placeholder="Select your birth date" />
                    <FieldDescription>We use this to verify your age.</FieldDescription>
                </Field>
                <p class="text-sm text-muted-foreground">
                    Selected: @(dateOfBirth?.ToString("D") ?? "None")
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Travel Dates</h2>
                <p class="text-muted-foreground">
                    Date range picker with custom labels for travel booking.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DateRangePicker @bind-StartDate="checkIn"
                                    @bind-EndDate="checkOut"
                                    StartDateLabel="Check-in"
                                    EndDateLabel="Check-out"
                                    MinDate="DateOnly.FromDateTime(DateTime.Today)"
                                    Placeholder="Select travel dates" />
                </div>
                <p class="text-sm text-muted-foreground">
                    Check-in: @(checkIn?.ToString("D") ?? "None")
                    <br />
                    Check-out: @(checkOut?.ToString("D") ?? "None")
                    @if (checkIn.HasValue && checkOut.HasValue)
                    {
                        var nights = checkOut.Value.DayNumber - checkIn.Value.DayNumber;
                        <br />
                        <span class="font-medium">@nights night@(nights != 1 ? "s" : "")</span>
                    }
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Date and Time Picker</h2>
                <p class="text-muted-foreground">
                    Combine date and time selection in a single input scenario.
                </p>
            </div>

            <div class="flex flex-col gap-4 max-w-sm">
                <Field>
                    <FieldLabel>Appointment Date & Time</FieldLabel>
                    <div class="flex gap-2">
                        <div class="flex-1">
                            <DatePicker @bind-SelectedDate="appointmentDate"
                                       MinDate="DateOnly.FromDateTime(DateTime.Today)"
                                       Placeholder="Select date"
                                       ShowIcon="false"
                                       ShowDropdownIcon="true" />
                        </div>
                        <div class="flex-1">
                            <TimePicker @bind-SelectedTime="appointmentTime"
                                       MinuteStep="15"
                                       Placeholder="Select time"
                                       ShowIcon="false" />
                        </div>
                    </div>
                    <FieldDescription>Choose your preferred appointment slot.</FieldDescription>
                </Field>
                <p class="text-sm text-muted-foreground">
                    @if (appointmentDate.HasValue && appointmentTime.HasValue)
                    {
                        var dateTime = new DateTime(appointmentDate.Value.Year, appointmentDate.Value.Month, appointmentDate.Value.Day, 
                                                    appointmentTime.Value.Hour, appointmentTime.Value.Minute, 0);
                        <span class="font-medium">Scheduled: @dateTime.ToString("dddd, MMMM d, yyyy 'at' h:mm tt")</span>
                    }
                    else if (appointmentDate.HasValue)
                    {
                        <span>Date: @appointmentDate.Value.ToString("D") - Time: Not selected</span>
                    }
                    else if (appointmentTime.HasValue)
                    {
                        <span>Date: Not selected - Time: @appointmentTime.Value.ToString("hh:mm tt")</span>
                    }
                    else
                    {
                        <span>No appointment scheduled</span>
                    }
                </p>
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Disabled State</h2>
                <p class="text-muted-foreground">
                    A disabled date picker.
                </p>
            </div>

            <div class="flex flex-col gap-4">
                <div>
                    <DatePicker @bind-SelectedDate="selectedDate6"
                               Disabled="true"
                               Placeholder="Disabled picker" />
                </div>
            </div>
        </section>
    </div>
</div>

@code {
    private DateOnly? selectedDate1;
    private DateOnly? selectedDate1b;
    private DateOnly? selectedDate2;
    private DateOnly? selectedDate3;
    private DateOnly? selectedDate4;
    private DateOnly? selectedDate5;
    private DateOnly? selectedDate6;
    private DateOnly? dateOfBirth;
    
    private DateOnly? startDate;
    private DateOnly? endDate;
    
    private DateOnly? checkIn;
    private DateOnly? checkOut;

    private DateOnly? appointmentDate;
    private TimeOnly? appointmentTime;

    private bool IsWeekend(DateOnly date)
    {
        return date.DayOfWeek == DayOfWeek.Saturday || 
               date.DayOfWeek == DayOfWeek.Sunday;
    }
}
