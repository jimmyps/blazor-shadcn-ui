@page "/charts/mvpplus"
@using BlazorUI.Components.Chart
@using BlazorUI.Components.Card

<PageTitle>MVP+ Chart Features</PageTitle>

<div class="space-y-8">
    <div>
        <h1 class="text-3xl font-bold">MVP+ Chart Extensions</h1>
        <p class="text-muted-foreground">Advanced features: Labels, Step Interpolation, Percentage Stacking, Radial Charts</p>
    </div>

    <!-- Line Chart with Labels and LabelList -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">Line Chart with Labels</h3>
            <p class="text-sm text-muted-foreground">Using ShowLabel parameter and LabelList component</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Sales with Data Labels</CardTitle>
                <CardDescription>Labels showing actual values at each data point</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <LineChart Data="@salesData">
                        <XAxis DataKey="month" />
                        <YAxis />
                        <Tooltip Mode="TooltipMode.Axis" />
                        <Legend />
                        <Line DataKey="sales" Name="Sales" ShowLabel="true" LabelPosition="LabelPosition.Top">
                            <LabelList Position="LabelPosition.Top" Formatter="{c}" FontSize="12" Color="#666" />
                        </Line>
                    </LineChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Line Chart with Step Interpolation -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">Line Chart with Step Interpolation</h3>
            <p class="text-sm text-muted-foreground">Using Interpolation="InterpolationType.Step"</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Step Chart</CardTitle>
                <CardDescription>Line chart with step interpolation</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <LineChart Data="@salesData">
                        <XAxis DataKey="month" />
                        <YAxis />
                        <Tooltip Mode="TooltipMode.Axis" />
                        <Legend />
                        <Line DataKey="sales" Name="Sales" Interpolation="InterpolationType.Step" />
                    </LineChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Area Chart with Step Before/After -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">Area Chart with Step Interpolation Variants</h3>
            <p class="text-sm text-muted-foreground">StepBefore and StepAfter interpolation types</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Step Interpolation Comparison</CardTitle>
                <CardDescription>Different step interpolation types</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <AreaChart Data="@salesData">
                        <XAxis DataKey="month" />
                        <YAxis />
                        <Tooltip Mode="TooltipMode.Axis" />
                        <Legend />
                        <Area DataKey="sales" Name="Step Before" Interpolation="InterpolationType.StepBefore" />
                    </AreaChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Area Chart with Percentage Stacking -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">100% Stacked Area Chart</h3>
            <p class="text-sm text-muted-foreground">Using StackOffset="StackOffset.Expand" for percentage stacking</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Desktop vs Mobile Distribution</CardTitle>
                <CardDescription>Percentage stacking showing relative proportions</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <AreaChart Data="@trafficData" StackOffset="StackOffset.Expand">
                        <XAxis DataKey="month" />
                        <YAxis />
                        <Tooltip Mode="TooltipMode.Axis" Formatter="function(params) { return params.seriesName + ': ' + params.value.toFixed(1) + '%'; }" />
                        <Legend />
                        <Area DataKey="desktop" StackId="1" Name="Desktop" />
                        <Area DataKey="mobile" StackId="1" Name="Mobile" />
                    </AreaChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Bar Chart with Percentage Stacking -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">100% Stacked Bar Chart</h3>
            <p class="text-sm text-muted-foreground">Percentage stacking on bar charts</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Market Share Distribution</CardTitle>
                <CardDescription>Percentage stacking showing market share over time</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <BarChart Data="@trafficData" StackOffset="StackOffset.Expand">
                        <XAxis DataKey="month" />
                        <YAxis />
                        <Tooltip Mode="TooltipMode.Axis" />
                        <Legend />
                        <Bar DataKey="desktop" StackId="1" Name="Desktop" />
                        <Bar DataKey="mobile" StackId="1" Name="Mobile" />
                    </BarChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Bar Chart with Labels -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">Bar Chart with Data Labels</h3>
            <p class="text-sm text-muted-foreground">Labels on top of bars</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Monthly Revenue with Labels</CardTitle>
                <CardDescription>Bar chart showing exact values</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <BarChart Data="@salesData">
                        <XAxis DataKey="month" />
                        <YAxis />
                        <Tooltip Mode="TooltipMode.Axis" />
                        <Legend />
                        <Bar DataKey="sales" Name="Revenue" ShowLabel="true" LabelPosition="LabelPosition.Top">
                            <LabelList Position="LabelPosition.Top" Formatter="{c}" FontSize="11" Color="#000" />
                        </Bar>
                    </BarChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Pie Chart with Labels and Label Lines -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">Pie Chart with Label Lines</h3>
            <p class="text-sm text-muted-foreground">Using ShowLabelLine and LabelLine component</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Browser Usage</CardTitle>
                <CardDescription>With label lines connecting to slices</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <PieChart Data="@browserData">
                        <Tooltip />
                        <Legend />
                        <Pie DataKey="value" NameKey="name" ShowLabel="true" ShowLabelLine="true">
                            <LabelList Position="LabelPosition.Outside" Formatter="{b}: {c}" />
                            <LabelLine Show="true" Length="15" Length2="10" Smooth="false" />
                        </Pie>
                    </PieChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Radial Bar Chart (Gauge) -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">Radial Bar Chart</h3>
            <p class="text-sm text-muted-foreground">True radial/gauge chart with polar coordinate system</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Progress Gauge</CardTitle>
                <CardDescription>Radial bar chart showing completion percentage</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <RadialBarChart Data="@gaugeData">
                        <PolarGrid Type="PolarGridType.Circle" Show="true" />
                        <XAxis DataKey="category" />
                        <RadialBar DataKey="value" Name="Progress" InnerRadius="60%" OuterRadius="80%" CornerRadius="10" />
                        <CenterLabel Text="75%" FontSize="32" Color="#000" FontWeight="bold" />
                    </RadialBarChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Stacked Radial Bar Chart -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">Stacked Radial Bar Chart</h3>
            <p class="text-sm text-muted-foreground">Multiple radial bars stacked</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Multi-Metric Dashboard</CardTitle>
                <CardDescription>Stacked radial bars showing multiple KPIs</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <RadialBarChart Data="@multiGaugeData">
                        <PolarGrid Type="PolarGridType.Circle" />
                        <XAxis DataKey="name" />
                        <Tooltip />
                        <Legend />
                        <RadialBar DataKey="desktop" Name="Desktop" StackId="1" InnerRadius="30%" OuterRadius="50%" />
                        <RadialBar DataKey="mobile" Name="Mobile" StackId="1" InnerRadius="55%" OuterRadius="75%" />
                        <CenterLabel Text="Metrics" FontSize="18" />
                    </RadialBarChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>

    <!-- Combined Example: All Features -->
    <div class="space-y-4">
        <div>
            <h3 class="text-lg font-semibold">Combined MVP+ Features</h3>
            <p class="text-sm text-muted-foreground">Step interpolation + labels + custom formatter</p>
        </div>
        
        <Card>
            <CardHeader>
                <CardTitle>Advanced Line Chart</CardTitle>
                <CardDescription>Combining multiple MVP+ features</CardDescription>
            </CardHeader>
            <CardContent>
                <ChartContainer Height="300">
                    <LineChart Data="@salesData">
                        <XAxis DataKey="month" />
                        <YAxis />
                        <Tooltip Mode="TooltipMode.Axis" Formatter="function(params) { return params.seriesName + ': $' + params.value.toLocaleString(); }" />
                        <Legend />
                        <Line DataKey="sales" Name="Revenue" Interpolation="InterpolationType.Step" ShowLabel="true" LabelPosition="LabelPosition.Top" ShowDots="true">
                            <LabelList Position="LabelPosition.Top" Formatter="function(params) { return '$' + params.value; }" FontSize="10" Color="#2563eb" />
                        </Line>
                    </LineChart>
                </ChartContainer>
            </CardContent>
        </Card>
    </div>
</div>

@code {
    private record ChartData(string month, int sales);
    private record TrafficData(string month, int desktop, int mobile);
    private record BrowserData(string name, int value);
    private record GaugeData(string category, int value);
    private record MultiGaugeData(string name, int desktop, int mobile);

    private List<ChartData> salesData = new()
    {
        new("Jan", 4000),
        new("Feb", 3000),
        new("Mar", 5000),
        new("Apr", 4500),
        new("May", 6000),
        new("Jun", 5500)
    };

    private List<TrafficData> trafficData = new()
    {
        new("Jan", 400, 240),
        new("Feb", 300, 139),
        new("Mar", 200, 380),
        new("Apr", 278, 390),
        new("May", 189, 480),
        new("Jun", 239, 380)
    };

    private List<BrowserData> browserData = new()
    {
        new("Chrome", 45),
        new("Firefox", 25),
        new("Safari", 15),
        new("Edge", 10),
        new("Other", 5)
    };

    private List<GaugeData> gaugeData = new()
    {
        new("Progress", 75)
    };

    private List<MultiGaugeData> multiGaugeData = new()
    {
        new("Q1", 65, 45),
        new("Q2", 75, 55),
        new("Q3", 85, 65),
        new("Q4", 90, 70)
    };
}
